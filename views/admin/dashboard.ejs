<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ููุญุฉ ุงูุชุญูู | ุงูุจูุช ุงูุฑูุณู</title>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<div class="admin-layout">
  <!-- Sidebar -->
  <aside class="admin-sidebar">
    <div class="sidebar-brand">๐ป ุงูุจูุช ุงูุฑูุณู<br><small style="font-size:10px;color:#666;font-weight:400">ููุญุฉ ุงูุชุญูู</small></div>
    <a href="/admin" class="sidebar-link active">๐ ุงูุทูุจุงุช</a>
    <a href="/admin/products" class="sidebar-link">๐ฆ ุงูููุชุฌุงุช</a>
    <a href="/admin/customers" class="sidebar-link">๐ฅ ุงูุนููุงุก</a>
    <a href="/" class="sidebar-link">๐ ุงููููุน</a>
    <a href="/auth/logout" class="sidebar-link" style="margin-top:auto;color:#e05252;">๐ช ุชุณุฌูู ุงูุฎุฑูุฌ</a>
  </aside>

  <!-- Main Content -->
  <main class="admin-main">
    <div class="admin-header">
      <h1>๐ ููุญุฉ ุงูุชุญูู</h1>
      <p>ูุฑุญุจุงู <%= currentUser.name %> โ <%= new Date().toLocaleDateString('ar-EG', {weekday:'long', year:'numeric', month:'long', day:'numeric'}) %></p>
    </div>

    <!-- Stats -->
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-card-icon">๐ฆ</div>
        <div class="stat-card-val"><%= stats.totalOrders %></div>
        <div class="stat-card-label">ุฅุฌูุงูู ุงูุทูุจุงุช</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon">โณ</div>
        <div class="stat-card-val"><%= stats.pendingOrders %></div>
        <div class="stat-card-label">ุทูุจุงุช ููุฏ ุงูุงูุชุธุงุฑ</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon">๐ฅ</div>
        <div class="stat-card-val"><%= stats.totalCustomers %></div>
        <div class="stat-card-label">ุงูุนููุงุก</div>
      </div>
      <div class="stat-card">
        <div class="stat-card-icon">๐ฐ</div>
        <div class="stat-card-val"><%= stats.totalRevenue.toLocaleString() %></div>
        <div class="stat-card-label">ุฅุฌูุงูู ุงูุฅูุฑุงุฏุงุช (ุฑูุงู)</div>
      </div>
    </div>

    <!-- Orders Table -->
    <div class="table-container">
      <div class="table-header">
        <h2>๐งพ ุงูุทูุจุงุช</h2>
        <div class="filter-btns">
          <a href="/admin" class="filter-btn <%= !statusFilter ? 'active' : '' %>">ุงููู</a>
          <a href="/admin?status=pending" class="filter-btn <%= statusFilter==='pending' ? 'active' : '' %>">ููุฏ ุงูุงูุชุธุงุฑ</a>
          <a href="/admin?status=processing" class="filter-btn <%= statusFilter==='processing' ? 'active' : '' %>">ููุฏ ุงูุชูููุฐ</a>
          <a href="/admin?status=completed" class="filter-btn <%= statusFilter==='completed' ? 'active' : '' %>">ููุชููุฉ</a>
          <a href="/admin?status=cancelled" class="filter-btn <%= statusFilter==='cancelled' ? 'active' : '' %>">ููุบูุฉ</a>
        </div>
      </div>

      <% if (orders.length === 0) { %>
        <div style="padding:40px;text-align:center;color:#666;">ูุง ุชูุฌุฏ ุทูุจุงุช</div>
      <% } else { %>
      <table>
        <thead>
          <tr>
            <th>ุฑูู ุงูุทูุจ</th>
            <th>ุงูุนููู</th>
            <th>ุงูููุชุฌุงุช</th>
            <th>ุงูุฅุฌูุงูู</th>
            <th>ุงูุญุงูุฉ</th>
            <th>ุงูุชุงุฑูุฎ</th>
            <th>ุชุญุฏูุซ</th>
          </tr>
        </thead>
        <tbody>
          <% orders.forEach(order => { %>
          <tr>
            <td><span class="order-id">#<%= order._id.toString().slice(-6).toUpperCase() %></span></td>
            <td>
              <div class="customer-name"><%= order.user?.name || 'ุบูุฑ ูุนุฑูู' %></div>
              <div style="font-size:11px;color:#666;"><%= order.user?.email %></div>
              <div style="font-size:11px;color:#666;"><%= order.shippingAddress?.city %></div>
            </td>
            <td style="max-width:200px;font-size:12px;color:#a0a0b0;">
              <%= order.items.map(i => `${i.productName} ร${i.quantity}`).join(', ') %>
            </td>
            <td style="font-weight:700;color:#d4af37;"><%= order.totalAmount %> ุฑ.ุณ</td>
            <td>
              <span class="status-badge status-<%= order.status %>">
                <% const labels = { pending:'ููุฏ ุงูุงูุชุธุงุฑ', processing:'ููุฏ ุงูุชูููุฐ', completed:'ููุชูู', cancelled:'ููุบู' } %>
                <%= labels[order.status] %>
              </span>
            </td>
            <td class="order-date"><%= new Date(order.createdAt).toLocaleDateString('ar-EG') %></td>
            <td>
              <select class="status-select" data-id="<%= order._id %>">
                <option value="pending" <%= order.status==='pending' ? 'selected' : '' %>>ููุฏ ุงูุงูุชุธุงุฑ</option>
                <option value="processing" <%= order.status==='processing' ? 'selected' : '' %>>ููุฏ ุงูุชูููุฐ</option>
                <option value="completed" <%= order.status==='completed' ? 'selected' : '' %>>ููุชูู</option>
                <option value="cancelled" <%= order.status==='cancelled' ? 'selected' : '' %>>ููุบู</option>
              </select>
            </td>
          </tr>
          <% }) %>
        </tbody>
      </table>
      <% } %>
    </div>
  </main>
</div>

<script src="/js/main.js"></script>
</body>
</html>
